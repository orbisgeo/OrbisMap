<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dashboard - Valor Venal do Im√≥vel</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
  <style>
    /* --- Color Palette & Fonts (Inspired by Orbis Map) --- */
    :root {
      --bg-dark: #1a1a1a; /* Darker background for overall page/header */
      --bg-medium-dark: #2c2c2c; /* Slightly lighter dark for panels */
      --text-light: #ffffff; /* Main text color */
      --text-medium-light: #b0b0b0; /* Subtitles, less prominent text */
      --accent-blue: #00aaff; /* Brighter, more vibrant blue */
      --accent-blue-hover: #0088cc; /* Darker blue on hover */
      --border-color: #444444; /* Subtle border for elements */
      --shadow-color: rgba(0, 0, 0, 0.5); /* Darker shadows for depth */
      --table-row-even: #383838; /* Slightly different background for even table rows */
      --input-focus-glow: rgba(0, 170, 255, 0.6); /* Blue glow on input focus */
      --editable-bg: #3c3c32; /* Background for editable table cells */
      --button-bg: #007bff; /* Button background */
      --button-hover-bg: #0056b3; /* Button hover background */
      --iptu-result-bg: #28a745; /* Green for IPTU result */
      --iptu-result-shadow: rgba(40, 167, 69, 0.4); /* Green shadow */

      --font-family-primary: 'Roboto', sans-serif;
    }

    body {
      font-family: var(--font-family-primary);
      background: var(--bg-dark);
      margin: 0;
      padding: 25px;
      color: var(--text-light);
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      box-sizing: border-box;
      line-height: 1.6;
      zoom: 0.7; /* Applied zoom level */
    }

    .dashboard-container {
      display: grid; /* Use grid for main layout */
      grid-template-columns: 1fr 1fr; /* Two columns for calculators */
      grid-template-rows: auto;
      grid-template-areas:
        "header header"
        "venal-calc iptu-calc"
        "formula formula"
        "tables tables"
        "footer footer";
      gap: 25px;
      max-width: 1100px; /* Wider to accommodate side-by-side */
      width: 100%;
      margin: auto;
    }

    .header-panel {
      grid-area: header; /* Assign to header area */
      text-align: center;
      padding: 40px 20px;
      background: linear-gradient(to bottom, #111111, #1a1a1a); /* Subtle gradient for header */
      border-radius: 10px;
      box-shadow: 0 5px 15px var(--shadow-color);
      position: relative;
      overflow: hidden;
    }

    .header-panel::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at center top, rgba(255,165,0,0.2) 0%, transparent 70%); /* Orange glow */
      z-index: 0;
    }
    .header-panel::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 50%;
      background: linear-gradient(to top, rgba(0,0,0,0.6), transparent);
      z-index: 1;
    }

    .header-content {
      position: relative;
      z-index: 2;
    }

    .header-panel h1 {
      font-size: 2.8em;
      font-weight: 700;
      color: var(--accent-blue);
      margin: 0 0 10px 0;
      letter-spacing: 1.2px;
      text-shadow: 0 0 12px rgba(0, 170, 255, 0.4);
    }

    .header-panel p {
      font-size: 1.1em;
      color: var(--text-medium-light);
      font-weight: 300;
      margin: 0;
    }

    .panel {
      background: var(--bg-medium-dark);
      border-radius: 10px;
      box-shadow: 0 4px 12px var(--shadow-color);
      padding: 25px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
    }

    h2 {
      text-align: center;
      color: var(--text-light);
      margin-bottom: 25px;
      font-size: 1.8em;
      font-weight: 500;
      border-bottom: 2px solid var(--border-color);
      padding-bottom: 15px;
    }

    /* Calculator Form Panel (Venal Value) */
    .formulario-panel {
      grid-area: venal-calc; /* Assign to venal-calc area */
    }

    .formulario label {
      display: block;
      margin-top: 18px;
      margin-bottom: 8px;
      font-weight: 400;
      color: var(--text-medium-light);
      font-size: 0.95em;
    }

    .formulario select,
    .formulario input[type="number"] {
      width: 100%;
      padding: 12px 15px;
      background-color: #444444; /* Darker input background */
      border: 1px solid var(--border-color);
      border-radius: 6px;
      font-size: 1em;
      color: var(--text-light);
      box-sizing: border-box;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
    }

    .formulario select:focus,
    .formulario input[type="number"]:focus {
      border-color: var(--accent-blue);
      outline: none;
      box-shadow: 0 0 0 4px var(--input-focus-glow);
    }
    .formulario input::placeholder {
      color: #aaaaaa;
    }

    .resultado {
      margin-top: 30px;
      padding: 20px;
      background-color: var(--accent-blue);
      border-radius: 8px;
      font-weight: 700;
      font-size: 2em;
      text-align: center;
      color: var(--text-light);
      box-shadow: 0 2px 8px var(--shadow-color);
    }

    /* IPTU Result specific styling */
    #resultadoIPTU {
        background-color: var(--iptu-result-bg);
        box-shadow: 0 2px 8px var(--iptu-result-shadow);
        margin-top: 20px; /* Space from Venal Value result */
    }


    /* Formula Panel */
    .formula-panel {
      grid-area: formula; /* Assign to formula area */
    }

    .formula {
      padding: 20px;
      background-color: #333333;
      border-left: 6px solid var(--accent-blue);
      border-radius: 8px;
    }

    .formula h3 {
      color: var(--text-light);
      font-size: 1.3em;
      margin-top: 0;
      margin-bottom: 15px;
    }

    .formula p {
      margin: 12px 0;
      line-height: 1.7;
      font-size: 0.95em;
      color: var(--text-medium-light);
    }

    .formula strong {
      color: var(--accent-blue);
      font-weight: 700;
    }

    /* New IPTU Calculator Panel */
    .iptu-panel {
        grid-area: iptu-calc; /* Assign to iptu-calc area */
    }

    /* Tables Container & Toggle Button */
    .tabelas-container {
      grid-area: tables; /* Assign to tables area */
      display: flex;
      flex-direction: column;
      align-items: center; /* Center the button */
      gap: 20px;
      padding: 0 25px; /* Adjust padding to match other panels */
    }

    .toggle-tables-button {
      background-color: var(--button-bg);
      color: var(--text-light);
      padding: 12px 25px;
      border: none;
      border-radius: 8px;
      font-size: 1.1em;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.3s ease, transform 0.2s ease;
      box-shadow: 0 4px 10px var(--shadow-color);
    }

    .toggle-tables-button:hover {
      background-color: var(--button-hover-bg);
      transform: translateY(-2px);
    }

    .tabelas-content {
      display: none; /* Hidden by default */
      width: 100%;
      background: var(--bg-medium-dark); /* Apply panel background here */
      border-radius: 10px;
      box-shadow: 0 4px 12px var(--shadow-color);
      padding: 25px;
      box-sizing: border-box;
    }

    .tabelas-content.active {
      display: block; /* Show when active */
    }

    .tabelas-content h3 {
      text-align: left;
      color: var(--text-light);
      margin-top: 0;
      margin-bottom: 15px;
      font-size: 1.3em;
      font-weight: 500;
      padding-top: 15px; /* Add some padding for visual separation */
      border-top: 1px solid var(--border-color); /* Separator for tables */
    }

    .tabelas-content h3:first-of-type {
        border-top: none; /* No border for the first table title */
        padding-top: 0;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3); /* Slightly less intense shadow for tables */
      border-radius: 8px;
      overflow: hidden;
    }

    table th,
    table td {
      padding: 14px 18px;
      border: 1px solid var(--border-color);
      text-align: left;
      font-size: 0.9em;
    }

    table th {
      background-color: var(--accent-blue);
      color: var(--text-light);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    table tr:nth-child(even) {
      background-color: var(--table-row-even);
    }
    table tr:nth-child(odd) {
      background-color: var(--bg-medium-dark);
    }

    table td[contenteditable="true"] {
      background-color: var(--editable-bg);
      cursor: text;
      color: var(--text-light);
    }

    /* Footer */
    .footer-panel {
      grid-area: footer; /* Assign to footer area */
      text-align: center;
      padding: 20px;
      background: linear-gradient(to top, #111111, #1a1a1a);
      border-radius: 10px;
      box-shadow: 0 -5px 15px var(--shadow-color);
      color: var(--text-medium-light);
      font-size: 0.9em;
      margin-top: 25px;
    }

    /* Responsive adjustments */
    @media (max-width: 1024px) {
      .dashboard-container {
        grid-template-columns: 1fr; /* Single column layout on smaller screens */
        grid-template-areas:
          "header"
          "venal-calc"
          "iptu-calc"
          "formula"
          "tables"
          "footer";
      }

      .tabelas-container {
        padding: 0; /* Remove horizontal padding on smaller screens */
      }
    }

    @media (max-width: 768px) {
      body {
        padding: 15px;
      }
      .header-panel {
        padding: 30px 15px;
      }
      .header-panel h1 {
        font-size: 2.2em;
      }
      .header-panel p {
        font-size: 1em;
      }
      .panel {
        padding: 20px;
      }
      h2 {
        font-size: 1.5em;
        margin-bottom: 20px;
      }
      .resultado {
        font-size: 1.6em;
        padding: 15px;
      }
      table th,
      table td {
        padding: 10px 12px;
        font-size: 0.85em;
      }
      .tabelas-content {
          padding: 20px; /* Adjust inner padding for table content */
      }
    }
  </style>
</head>
<body>
  <div class="dashboard-container">
    <div class="header-panel">
        <div class="header-content">
            <h1>C√°lculo de Valor Venal do Im√≥vel</h1>
            <p>Intelig√™ncia Imobili√°ria para decis√µes precisas.</p>
        </div>
    </div>

    <div class="panel formulario-panel">
      <h2>Dados do Im√≥vel</h2>
      <div class="formulario">
        <label for="bairro">Bairro:</label>
        <select id="bairro"></select>

        <label for="pavimentacao">Tipo de Pavimenta√ß√£o:</label>
        <select id="pavimentacao">
          <option value="1">ASFALTO</option>
          <option value="0.9">PARALELEPIPEDO</option>
          <option value="0.8">SEMI-PAVIMENTADA</option>
          <option value="0.7">SEM PAVIMENTA√á√ÉO</option>
        </select>

        <label for="areaLote">√Årea do Lote (m¬≤):</label>
        <input type="number" id="areaLote" placeholder="Ex: 250" />

        <label for="padrao">Padr√£o Construtivo:</label>
        <select id="padrao">
          <option value="1020.47">BAIXO</option>
          <option value="1519.96">NORMAL</option>
          <option value="1960.44">ALTO</option>
          <option value="1705.97">INDUSTRIAL E RESID√äNCIA POPULAR</option>
        </select>

        <label for="areaConstruida">√Årea Constru√≠da (m¬≤):</label>
        <input type="number" id="areaConstruida" placeholder="Ex: 100" />

        <div class="resultado" id="resultado">Valor Venal: R$ 0,00</div>
      </div>
    </div>

    <div class="panel iptu-panel">
        <h2>C√°lculo de IPTU</h2>
        <div class="formulario">
            <label for="anoReferencia">Ano de Refer√™ncia do IPTU:</label>
            <input type="number" id="anoReferencia" placeholder="Ex: 2025" value="2025" min="2025"/>
            <div class="resultado" id="resultadoIPTU">IPTU: R$ 0,00</div>
        </div>
    </div>

    <div class="panel formula-panel">
      <h2>F√≥rmulas de C√°lculo - PGV</h2>
      <div class="formula">
        <p><strong>Valor venal = valor do lote + valor da constru√ß√£o</strong></p>
        <p><strong>Valor do lote =</strong> valor do bairro &times; fator multiplicador da pavimenta√ß√£o &times; √°rea do lote</p>
        <p><strong>Valor da constru√ß√£o =</strong> √°rea constru√≠da &times; valor por m¬≤ conforme padr√£o construtivo</p>
      </div>
    </div>

    <div class="tabelas-container">
      <button class="toggle-tables-button" id="toggleTablesBtn">Exibir Tabelas de Refer√™ncia</button>
      <div class="tabelas-content" id="tabelasContent">
        <h3>Valor do m¬≤ por Bairro</h3>
        <table contenteditable="true">
          <thead>
            <tr>
              <th>ID</th>
              <th>NOME</th>
              <th>C√ìDIGO</th>
              <th>VALOR (R$/m¬≤)</th>
            </tr>
          </thead>
          <tbody>
            <tr><td>1</td><td>WALTER MARTINS</td><td>01</td><td>26,67</td></tr>
            <tr><td>2</td><td>PASTO NOVO</td><td>02</td><td>88,89</td></tr>
            <tr><td>3</td><td>SONHO MEU</td><td>03</td><td>88,89</td></tr>
            <tr><td>4</td><td>SILVINO COSTA</td><td>04</td><td>133,33</td></tr>
            <tr><td>5</td><td>CENTRO</td><td>05</td><td>133,33</td></tr>
            <tr><td>6</td><td>JOS√â AM√âRICO</td><td>06</td><td>77,78</td></tr>
            <tr><td>7</td><td>CHICO FAUSTINO</td><td>07</td><td>22,22</td></tr>
            <tr><td>8</td><td>ARA√á√Å</td><td>08</td><td>88,89</td></tr>
            <tr><td>9</td><td>PROCANOR</td><td>09</td><td>17,78</td></tr>
            <tr><td>10</td><td>AMOR DIVINO</td><td>10</td><td>22,22</td></tr>
            <tr><td>11</td><td>BAIRRO VERMELHO</td><td>11</td><td>44,44</td></tr>
            <tr><td>12</td><td>NOVA ESPERAN√áA</td><td>12</td><td>44,44</td></tr>
          </tbody>
        </table>

        <h3>Fatores por Tipo de Pavimenta√ß√£o</h3>
        <table contenteditable="true">
          <thead>
            <tr>
              <th>ID</th>
              <th>TIPO DE PAVIMENTA√á√ÉO</th>
              <th>FATOR MULTIPLICADOR</th>
            </tr>
          </thead>
          <tbody>
            <tr><td>1</td><td>ASFALTO</td><td>1,0</td></tr>
            <tr><td>2</td><td>PARALELEPIPEDO</td><td>0,9</td></tr>
            <tr><td>4</td><td>SEMI-PAVIMENTADA</td><td>0,8</td></tr>
            <tr><td>3</td><td>SEM PAVIMENTA√á√ÉO</td><td>0,7</td></tr>
          </tbody>
        </table>

        <h3>Tabela CUB - SINDUSCON/PB</h3>
        <table contenteditable="true">
          <thead>
            <tr>
              <th>ID</th>
              <th>PADR√ÉO CONSTRUTIVO</th>
              <th>VALOR (R$/m¬≤)</th>
            </tr>
          </thead>
          <tbody>
            <tr><td>1</td><td>BAIXO</td><td>1020,47</td></tr>
            <tr><td>2</td><td>NORMAL</td><td>1519,96</td></tr>
            <tr><td>3</td><td>ALTO</td><td>1960,44</td></tr>
            <tr><td>4</td><td>INDUSTRIAL E RESID√äNCIA POPULAR</td><td>1705.97</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="footer-panel">
        ¬© 2025 Valor Venal Calculadora ‚Äì Todos os direitos reservados.
    </div>
  </div>

  <script>
    const bairros = [
      "WALTER MARTINS", "PASTO NOVO", "SONHO MEU", "SILVINO COSTA",
      "CENTRO", "JOS√â AM√âRICO", "CHICO FAUSTINO", "ARA√á√Å",
      "PROCANOR", "AMOR DIVINO", "BAIRRO VERMELHO", "NOVA ESPERAN√áA"
    ];

    const valores = [
      26.66666667, 88.88888889, 88.88888889, 133.3333333,
      133.3333333, 77.77777778, 22.22222222, 88.88888889,
      17.77777778, 22.22222222, 44.44444444, 44.44444444
    ];

    const bairroSelect = document.getElementById("bairro");
    bairros.forEach((bairro, index) => {
      const option = document.createElement("option");
      option.value = valores[index];
      option.text = bairro;
      bairroSelect.appendChild(option);
    });

    // Event listeners for all input fields to trigger calculation
    document.querySelectorAll("#bairro, #pavimentacao, #areaLote, #padrao, #areaConstruida").forEach(input => {
      input.addEventListener("input", () => {
        calcularValorVenal();
        calcularIPTU(); // Recalculate IPTU when venal value changes
      });
    });

    // Event listener for the IPTU reference year input
    document.getElementById("anoReferencia").addEventListener("input", calcularIPTU);

    let currentValorVenal = 0; // Store the calculated venal value for IPTU calculation

    function calcularValorVenal() {
      const valorBairro = parseFloat(document.getElementById("bairro").value);
      const fatorPavimentacao = parseFloat(document.getElementById("pavimentacao").value);
      const areaLote = parseFloat(document.getElementById("areaLote").value);
      const padraoValor = parseFloat(document.getElementById("padrao").value);
      const areaConstruida = parseFloat(document.getElementById("areaConstruida").value);

      if (!isNaN(valorBairro) && !isNaN(fatorPavimentacao) && !isNaN(areaLote) && !isNaN(padraoValor) && !isNaN(areaConstruida)) {
        const valorLote = valorBairro * fatorPavimentacao * areaLote;
        const valorConstrucao = padraoValor * areaConstruida;
        const valorVenal = valorLote + valorConstrucao;
        currentValorVenal = valorVenal; // Update global variable

        document.getElementById("resultado").innerText = `Valor Venal: R$ ${valorVenal.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
      } else {
        document.getElementById("resultado").innerText = "Preencha todos os campos.";
        currentValorVenal = 0; // Reset venal value if inputs are incomplete
      }
    }

    function calcularIPTU() {
        const anoReferencia = parseInt(document.getElementById("anoReferencia").value);

        if (isNaN(anoReferencia) || currentValorVenal === 0) {
            document.getElementById("resultadoIPTU").innerText = "IPTU: R$ 0,00";
            return;
        }

        const baseAliquot = 0.0005; // 0.05% - New base aliquot
        const maxAliquot = 0.001;   // 0.1% - New max aliquot
        const annualIncrease = 0.00005; // 0.005% increase per year for a gradual progression over 10 years

        const startYear = 2025; // Assuming progression starts from 2025

        let currentAliquot = baseAliquot;

        if (anoReferencia > startYear) {
            const yearsPassed = anoReferencia - startYear;
            currentAliquot = baseAliquot + (yearsPassed * annualIncrease);
            // Cap the aliquot at the maximum
            if (currentAliquot > maxAliquot) {
                currentAliquot = maxAliquot;
            }
        }

        const valorIPTU = currentValorVenal * currentAliquot;
        document.getElementById("resultadoIPTU").innerText = `IPTU: R$ ${valorIPTU.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
    }


    // Table visibility toggle
    const toggleTablesBtn = document.getElementById("toggleTablesBtn");
    const tabelasContent = document.getElementById("tabelasContent");

    toggleTablesBtn.addEventListener("click", () => {
      tabelasContent.classList.toggle("active");
      if (tabelasContent.classList.contains("active")) {
        toggleTablesBtn.textContent = "Ocultar Tabelas de Refer√™ncia";
      } else {
        toggleTablesBtn.textContent = "Exibir Tabelas de Refer√™ncia";
      }
    });

    // Initial calculation when the page loads
    calcularValorVenal();
    calcularIPTU();
  </script>
</body>
</html>
